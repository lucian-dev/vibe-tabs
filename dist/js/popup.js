(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t,o){chrome.runtime.sendMessage({type:"showNotification",title:e,message:t,url:o},(function(e){chrome.runtime.lastError?console.error("Message error:",chrome.runtime.lastError):console.log("Message sent:",e)}))}document.addEventListener("DOMContentLoaded",(function(){var o=document.getElementById("createNewMood"),n=document.getElementById("openOptions"),c=document.getElementById("deactivateMood");function i(){chrome.storage.local.get(["moods","activeMoodIndex"],(function(r){var a=r.moods||[],d=r.activeMoodIndex;c.style.display=void 0!==d?"block":"none",0===a.length?(o.style.display="inline-flex",n.style.display="none"):(o.style.display="none",n.style.display="inline-flex"),function(e,t,o,n,c,i){var r=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];if(t.innerHTML="",0===e.length){var a=document.createElement("div");return a.className="no-moods-message",a.innerHTML='\n      <p>No moods created yet.</p>\n      <p>Click "Create New Mood" to get started!</p>\n    ',void t.appendChild(a)}e.forEach((function(a,d){var s=document.createElement("div");s.className="mood-item",d===i&&s.classList.add("active-mood"),s.innerHTML="\n      <span>".concat(a.name,'</span>\n      <div class="action-buttons">\n        ').concat(d===i?"<span>Active Mood</span>":r?'\n            <button class="edit-button" data-index="'.concat(d,'">Edit</button>\n            <button class="delete-button" data-index="').concat(d,'">Delete</button>\n          '):"<span>Not active</span>","\n      </div>\n    "),s.addEventListener("click",(function(){c&&c(d,e)})),r&&d!==i&&(s.querySelector(".edit-button").addEventListener("click",(function(t){t.stopPropagation(),o&&o(d,e)})),s.querySelector(".delete-button").addEventListener("click",(function(t){t.stopPropagation(),n&&n(d,e)}))),t.appendChild(s)}))}(a,document.getElementById("moodList"),null,null,(function(o,n){return function(o,n,c){if(n&&n[o]){var i=n[o],r=[];chrome.storage.local.get("activeMoodIndex",(function(n){n.activeMoodIndex!==o?(chrome.storage.local.set({activeMoodIndex:o},(function(){console.log("Active mood index set to ".concat(o))})),chrome.tabs.query({active:!0,currentWindow:!0},(function(o){var n=o[0],a=n.id;chrome.tabs.query({currentWindow:!0},(function(o){var d=o.filter((function(e){return e.id!==n.id})).map((function(e){return e.id}));chrome.tabs.remove(d,(function(){i.tabs.forEach((function(t,o){var n="object"===e(t)?t.url:t;chrome.tabs.create({url:n,active:0===o},(function(e){r.push(e.id)}))})),i.music&&chrome.tabs.create({url:i.music,pinned:!0}),chrome.tabs.update(a,{active:!0}),t("Mood Activated","".concat(i.name," mood activated!"),chrome.runtime.getURL("src/options/options.html")),c&&c(),chrome.runtime.sendMessage({type:"refreshMoods"})}))}))}))):t("Mood Already Active","".concat(i.name," mood is already active!"),chrome.runtime.getURL("src/options/options.html"))}))}else console.error("Moods array is undefined or index is out of bounds")}(o,n,i)}),d,!1)}))}i(),o.addEventListener("click",(function(){chrome.tabs.create({url:chrome.runtime.getURL("src/welcome/welcome.html")})})),n.addEventListener("click",(function(){chrome.runtime.openOptionsPage()})),c.addEventListener("click",(function(){var e;e=function(){i()},chrome.storage.local.get("activeMoodIndex",(function(o){void 0!==o.activeMoodIndex?chrome.storage.local.remove("activeMoodIndex",(function(){console.log("Active mood deactivated!"),chrome.tabs.query({currentWindow:!0},(function(o){var n=o.find((function(e){return e.active})),c=o.filter((function(e){return e.id!==n.id})).map((function(e){return e.id}));chrome.tabs.remove(c,(function(){t("Mood Deactivated","No mood is currently active!",chrome.runtime.getURL("src/options/options.html")),e&&e(),chrome.runtime.sendMessage({type:"refreshMoods"})}))}))})):(console.log("No active mood to deactivate!"),e&&e())}))})),chrome.runtime.onMessage.addListener((function(e,t,o){"refreshMoods"===e.type&&i()}))}))})();